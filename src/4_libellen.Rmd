# Libellen

```{r}
sg <- "libellen"
```

## Overzicht monitoringsinspanning

```{r}

overzicht_bezoeken_tellers %>%
  filter(soortgroep == sg) %>%
  select(-soortgroep) %>%
  kable() %>%
  kable_styling("bordered", bootstrap_options = c("hover", "condensed")) %>%
  collapse_rows(1) %>%
  scroll_box(width = "100%", height = "600px")

```

## Overzicht getelde aantallen {.tabset}

### Primaire soorten

```{r}

# overzicht_aantallen_levensstadium_primair_wide %>%
#   filter(soortgroep == sg) %>%
#   filter(levensstadium != "larvenhuidje" | meetnet %in% c("Rivierrombout", "Beekrombout")) %>%
#   mutate(type_waarneming = ifelse(activiteit == "copula", "copula",
#                                   ifelse(activiteit == "eiafzettend", "eiafzettend",
#                                          ifelse(levensstadium == "imago (niet uitgekleurd)", "imago (niet uitgekleurd)",
#                                                 str_c(levensstadium, geslacht, sep = " "))))) %>%
#   arrange(meetnet, type_waarneming) %>%
#   select( meetnet, soort_wet, "type waarneming" = type_waarneming, aantal, "2016", "2017", "2018", "2019") %>%
#   # select(-soortgroep, -soort_nl) %>%
#   kable() %>%
#   kable_styling(bootstrap_options = c("hover", "condensed")) %>%
#     collapse_rows(c(1,2,3)) %>%
#   scroll_box(width = "100%", height = "600px")

overzicht_aantallen_levensstadium_primair_wide %>%
  filter(soortgroep == sg) %>%
  filter(levensstadium != "larvenhuidje" | meetnet %in% c("Rivierrombout", "Beekrombout")) %>%
  select(-soortgroep, -soort_nl, "Nederlandse naam" = meetnet, "wetenschappelijke naam" = soort_wet) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("hover", "condensed")) %>%
    column_spec(2, italic = TRUE) %>%
    collapse_rows(c(1,2,3), target = 1) %>%
  scroll_box(width = "100%", height = "600px")
  
```

### Overige soorten

```{r}
# overzicht_aantallen_overige_wide %>%
#   filter(soortgroep == sg) %>%
#   #filter(levensstadium != "larvenhuidje" | meetnet %in% c("Rivierrombout", "Beekrombout")) %>%
#   mutate(type_waarneming = ifelse(activiteit == "copula", "copula",
#                                   ifelse(activiteit == "eiafzettend", "eiafzettend",
#                                          ifelse(levensstadium == "imago (niet uitgekleurd)", "imago (niet uitgekleurd)",
#                                                 str_c(levensstadium, geslacht, sep = " "))))) %>%
#   arrange(soort_nl, type_waarneming) %>%
#   select(soort_nl , soort_wet, "type waarneming" = type_waarneming,  "2016", "2017", "2018", "2019") %>%
#   kable() %>%
#   kable_styling(bootstrap_options = c("hover", "condensed")) %>%
#     collapse_rows(c(1,2)) %>%
#   scroll_box(width = "100%", height = "600px")

overzicht_aantallen_levensstadium_overige_wide %>%
  filter(soortgroep == sg) %>%
  select(-soortgroep, "Nederlandse naam" = soort_nl, "wetenschappelijke naam" = soort_wet) %>%
  kable() %>%
  kable_styling("bordered", bootstrap_options = c("hover", "condensed")) %>%
    column_spec(2, italic = TRUE) %>%
    collapse_rows(c(1,2,3), target = 1) %>%
  scroll_box(width = "100%", height = "600px")
```

## Verkenning getelde aantallen {.tabset}

### Bosbeekjuffer

```{r}
soort <- "Bosbeekjuffer"

```

```{r Bosbeekjuffergemiddeld, fig.cap= str_c("Evolutie gemiddelde getelde aantallen per bezoek: ", soort), fig.height= 3, fig.width= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
  filter(levensstadium == "imago") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort) 

aantallen_soort_stadium %>%
  ggplot(aes(x= jaar, y = aantal)) +  
  #geom_point(alpha = 0.6, colour = inbo.grijs) +
  stat_summary(fun.data = "mean_cl_boot", colour = inbo_rood, size = 1, alpha = 0.8) +
  facet_wrap(~ soort_stadium, scale = "free_y") +
  labs(y = "Aantal getelde individuen", x = "Jaar") +
  theme(legend.position = "bottom") 

```

```{r Bosbeekjuffer, fig.cap= str_c("Evolutie getelde individuen binnen telperiode: ", soort) , message=FALSE, warning= FALSE, fig.width= 5, fig.height= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
    filter(levensstadium == "imago") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort ) %>%
   mutate(doy_date = as.Date(doy, origin = "2016-01-01"))

max_soort <- max(aantallen_soort_stadium$aantal) * 1.2

 p <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal,
             group= locatie)) + 
  geom_point(alpha = 0.6) +  
 geom_line(linetype = 2,  alpha = 0.6, size = 0.4, colour = inbo_grijsblauw)  + 
  facet_grid(soort_nl ~ jaar) +
  labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90))
  p #ggplotly(p) 

 q <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal)) + 
  geom_point(alpha = 0.6) + 
  geom_smooth(method = "gam", method.args = list(family = poisson),formula = y ~ s(x, bs = "cs", k = 5) , size = 0.4, colour = "blue") +
  facet_grid(soort_nl ~ jaar) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
   labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90)) 
 q
 
```

### Gevlekte witsnuitlibel

```{r}
soort <- "Gevlekte witsnuitlibel"

```

```{r Gevlektewitsnuitlibelgemiddeld, fig.cap= str_c("Evolutie gemiddelde getelde aantallen per bezoek: ", soort), fig.height= 3, fig.width= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
  filter(levensstadium == "imago") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort) 

aantallen_soort_stadium %>%
  ggplot(aes(x= jaar, y = aantal)) +  
  #geom_point(alpha = 0.6, colour = inbo.grijs) +
  stat_summary(fun.data = "mean_cl_boot", colour = inbo_rood, size = 1, alpha = 0.8) +
  facet_wrap(~ soort_stadium, scale = "free_y") +
  labs(y = "Aantal getelde individuen", x = "Jaar") +
  theme(legend.position = "bottom") 

```

```{r Gevlektewitsnuitlibel, fig.cap= str_c("Evolutie getelde individuen binnen telperiode: ", soort) , message=FALSE, warning= FALSE, fig.width= 8, fig.height= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort ) %>%
    filter(levensstadium == "imago") %>%
   mutate(doy_date = as.Date(doy, origin = "2016-01-01"))

max_soort <- max(aantallen_soort_stadium$aantal) * 1.2

 p <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal,
             group= locatie)) + 
  geom_point(alpha = 0.6) +  
 geom_line(linetype = 2,  alpha = 0.6, size = 0.4, colour = inbo_grijsblauw)  + 
  facet_grid(soort_nl ~ jaar) +
  labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90))
  p #ggplotly(p) 

 q <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal)) + 
  geom_point(alpha = 0.6) + 
  geom_smooth(method = "gam", method.args = list(family = poisson),formula = y ~ s(x, bs = "cs", k = 5) , size = 0.4, colour = "blue") +
  facet_grid(soort_nl ~ jaar) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
   labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90)) 
 q #ggplotly(q)
 
```
### Hoogveenglanslibel

```{r}
soort <- "Hoogveenglanslibel"

```


```{r Hoogveenglanslibelgemiddeld, fig.cap= str_c("Evolutie gemiddelde getelde aantallen per bezoek: ", soort), fig.height= 3, fig.width= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
  filter(levensstadium == "imago") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort) 

aantallen_soort_stadium %>%
  ggplot(aes(x= jaar, y = aantal)) +  
  #geom_point(alpha = 0.6, colour = inbo.grijs) +
  stat_summary(fun.data = "mean_cl_boot", colour = inbo_rood, size = 1, alpha = 0.8) +
  facet_wrap(~ soort_stadium, scale = "free_y") +
  labs(y = "Aantal getelde individuen", x = "Jaar") +
  theme(legend.position = "bottom") 
```

```{r Hoogveenglanslibel, fig.cap= str_c("Evolutie getelde individuen binnen telperiode: ", soort) , message=FALSE, warning= FALSE, fig.width= 5, fig.height= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort ) %>%
    filter(levensstadium == "imago") %>%
   mutate(doy_date = as.Date(doy, origin = "2016-01-01"))

max_soort <- max(aantallen_soort_stadium$aantal) * 1.2

 p <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal,
             group= locatie)) + 
  geom_point(alpha = 0.6) +  
 geom_line(linetype = 2,  alpha = 0.6, size = 0.4, colour = inbo_grijsblauw)  + 
  facet_grid(soort_nl ~ jaar) +
  labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90))
  p #ggplotly(p) 


```

### Kempense heidelibel

```{r}
soort <- "Kempense heidelibel"

```

```{r Kempenseheidelibelgemiddeld, fig.cap= str_c("Evolutie gemiddelde getelde aantallen per bezoek: ", soort), fig.height= 3, fig.width= 4}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
  filter(levensstadium == "imago") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort) 

aantallen_soort_stadium %>%
  ggplot(aes(x= jaar, y = aantal)) +  
  #geom_point(alpha = 0.6, colour = inbo.grijs) +
  stat_summary(fun.data = "mean_cl_boot", colour = inbo_rood, size = 1, alpha = 0.8) +
  facet_wrap(~ soort_stadium, scale = "free_y") +
  labs(y = "Aantal getelde individuen", x = "Jaar") +
  theme(legend.position = "bottom") 

```

```{r Kempenseheidelibel, fig.cap= str_c("Evolutie getelde individuen binnen telperiode: ", soort) , message=FALSE, warning= FALSE, fig.width= 8, fig.height= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort ) %>%
    filter(levensstadium == "imago") %>%
   mutate(doy_date = as.Date(doy, origin = "2016-01-01"))

max_soort <- max(aantallen_soort_stadium$aantal) * 1.2

 p <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal,
             colour = locatie,
             group= locatie)) + 
  geom_point(alpha = 0.6) +  
 geom_line(linetype = 2,  alpha = 0.6, size = 0.4, colour = inbo_grijsblauw)  + 
  facet_grid(soort_nl ~ jaar) +
  labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90))
  p #ggplotly(p) 
 
```


### Maanwaterjuffer

```{r}
soort <- "Maanwaterjuffer"

```

```{r Maanwaterjuffergemiddeld, fig.cap= str_c("Evolutie gemiddelde getelde aantallen per bezoek: ", soort), fig.height= 3, fig.width= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
  filter(levensstadium == "imago") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort) 

aantallen_soort_stadium %>%
  ggplot(aes(x= jaar, y = aantal)) +  
  #geom_point(alpha = 0.6, colour = inbo.grijs) +
  stat_summary(fun.data = "mean_cl_boot", colour = inbo_rood, size = 1, alpha = 0.8) +
  facet_wrap(~ soort_stadium, scale = "free_y") +
  labs(y = "Aantal getelde individuen", x = "Jaar") +
  theme(legend.position = "bottom") 

```

```{r Maanwaterjuffer, fig.cap= str_c("Evolutie getelde individuen binnen telperiode: ", soort) , message=FALSE, warning= FALSE, fig.width= 8, fig.height= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort ) %>%
    filter(levensstadium == "imago") %>%
   mutate(doy_date = as.Date(doy, origin = "2016-01-01"))

max_soort <- max(aantallen_soort_stadium$aantal) * 1.2

 p <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal,
             group= locatie,
             colour = locatie)) + 
  geom_point(alpha = 0.6) +  
 geom_line(linetype = 2,  alpha = 0.6, size = 0.4, colour = inbo_grijsblauw)  + 
  facet_grid(soort_nl ~ jaar) +
  labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90))
  p #ggplotly(p) 

 q <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal, 
 #            size = aantalSectiesGeteld, 
             colour = locatie)) + 
  geom_point(alpha = 0.6) + 
  geom_smooth(method = "gam", method.args = list(family = poisson),formula = y ~ s(x, bs = "cs", k = 5) , size = 0.4, colour = "blue") +
  facet_grid(soort_nl ~ jaar) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
   labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90)) 
  
```
### Sierlijke witsnuitlibel

```{r}
soort <- "Sierlijke witsnuitlibel"

```

```{r Sierlijkewitsnuitlibelgemiddeld, fig.cap= str_c("Evolutie gemiddelde getelde aantallen per bezoek: ", soort), fig.height= 3, fig.width= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
  filter(levensstadium == "imago") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort) 

aantallen_soort_stadium %>%
  ggplot(aes(x= jaar, y = aantal)) +  
  #geom_point(alpha = 0.6, colour = inbo.grijs) +
  stat_summary(fun.data = "mean_cl_boot", colour = inbo_rood, size = 1, alpha = 0.8) +
  facet_wrap(~ soort_stadium, scale = "free_y") +
  labs(y = "Aantal getelde individuen", x = "Jaar") +
  theme(legend.position = "bottom") 
```


```{r Sierlijkewitsnuitlibel, fig.cap= str_c("Evolutie getelde individuen binnen telperiode: ", soort) , message=FALSE, warning= FALSE, fig.width= 3, fig.height= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort ) %>%
    filter(levensstadium == "imago") %>%
   mutate(doy_date = as.Date(doy, origin = "2016-01-01"))

max_soort <- max(aantallen_soort_stadium$aantal) * 1.2

 p <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal,
             group= locatie, 
             colour = locatie)) + 
  geom_point(alpha = 0.6) +  
 geom_line(linetype = 2,  alpha = 0.6, size = 0.4, colour = inbo_grijsblauw)  + 
  facet_grid(soort_nl ~ jaar) +
  labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  scale_x_date(date_breaks = "1 week", date_labels = "%b %d") +
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90))
  p #ggplotly(p) 

 
```






### Speerwaterjuffer

```{r}
soort <- "Speerwaterjuffer"

```

```{r Speerwaterjuffergemiddeld, fig.cap= str_c("Evolutie gemiddelde getelde aantallen per bezoek: ", soort), fig.height= 3, fig.width= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
  filter(levensstadium == "imago") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort) 

aantallen_soort_stadium %>%
  ggplot(aes(x= jaar, y = aantal)) +  
  #geom_point(alpha = 0.6, colour = inbo.grijs) +
  stat_summary(fun.data = "mean_cl_boot", colour = inbo_rood, size = 1, alpha = 0.8) +
  facet_wrap(~ soort_stadium, scale = "free_y") +
  labs(y = "Aantal getelde individuen", x = "Jaar") +
  theme(legend.position = "bottom") 
```


```{r Speerwaterjuffer, fig.cap= str_c("Evolutie getelde individuen binnen telperiode: ", soort) , message=FALSE, warning= FALSE, fig.width= 6, fig.height= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort ) %>%
    filter(levensstadium == "imago") %>%
   mutate(doy_date = as.Date(doy, origin = "2016-01-01"))


max_soort <- max(aantallen_soort_stadium$aantal) * 1.2

 p <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal,
             group= locatie,
             colour = locatie)) + 
  geom_point(alpha = 0.6) +  
 geom_line(linetype = 2,  alpha = 0.6, size = 0.4, colour = inbo_grijsblauw)  + 
  facet_grid(soort_nl ~ jaar) +
  labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90))
  p #ggplotly(p) 

 q <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal
 #            size = aantalSectiesGeteld
              )) + 
  geom_point(alpha = 0.6) + 
  geom_smooth(method = "gam", method.args = list(family = poisson),formula = y ~ s(x, bs = "cs", k = 5) , size = 0.4, colour = "blue") +
  facet_grid(soort_nl ~ jaar) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
   labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90)) 
 q
```

### Variabele waterjuffer

```{r}
soort <- "Variabele waterjuffer"

```


```{r Variabelewaterjuffergemiddeld, fig.cap= str_c("Evolutie gemiddelde getelde aantallen per bezoek: ", soort), fig.height= 3, fig.width= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
  filter(levensstadium == "imago") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort) 

aantallen_soort_stadium %>%
  ggplot(aes(x= jaar, y = aantal)) +  
  #geom_point(alpha = 0.6, colour = inbo.grijs) +
  stat_summary(fun.data = "mean_cl_boot", colour = inbo_rood, size = 1, alpha = 0.8) +
  facet_wrap(~ soort_stadium, scale = "free_y") +
  labs(y = "Aantal getelde individuen", x = "Jaar") +
  theme(legend.position = "bottom") 

```

```{r Variabelewaterjuffer, fig.cap= str_c("Evolutie getelde individuen binnen telperiode: ", soort) , message=FALSE, warning= FALSE, fig.width= 6, fig.height= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort ) %>%
    filter(levensstadium == "imago") %>%
   mutate(doy_date = as.Date(doy, origin = "2016-01-01"))

max_soort <- max(aantallen_soort_stadium$aantal) * 1.2

 p <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal,
             group= locatie)) + 
  geom_point(alpha = 0.6) +  
 geom_line(linetype = 2,  alpha = 0.6, size = 0.4, colour = inbo_grijsblauw)  + 
  facet_grid(soort_nl ~ jaar) +
  labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90))
  p #ggplotly(p) 

 q <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal)) + 
  geom_point(alpha = 0.6) + 
  geom_smooth(method = "gam", method.args = list(family = poisson),formula = y ~ s(x, bs = "cs", k = 5) , size = 0.4, colour = "blue") +
  facet_grid(soort_nl ~ jaar) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
   labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90)) 
 q
 
```


### Vroege glazenmaker

```{r}
soort <- "Vroege glazenmaker"

```


```{r Vroegeglazenmakergemiddeld, fig.cap= str_c("Evolutie gemiddelde getelde aantallen per bezoek: ", soort), fig.height= 3, fig.width= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
  filter(levensstadium == "imago") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort) 

aantallen_soort_stadium %>%
  ggplot(aes(x= jaar, y = aantal)) +  
  #geom_point(alpha = 0.6, colour = inbo.grijs) +
  stat_summary(fun.data = "mean_cl_boot", colour = inbo_rood, size = 1, alpha = 0.8) +
  facet_wrap(~ soort_stadium, scale = "free_y") +
  labs(y = "Aantal getelde individuen", x = "Jaar") +
  theme(legend.position = "bottom") 

```

```{r Vroegeglazenmaker, fig.cap= str_c("Evolutie getelde individuen binnen telperiode: ", soort) , message=FALSE, warning= FALSE, fig.width= 6, fig.height= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort ) %>%
    filter(levensstadium == "imago") %>%
   mutate(doy_date = as.Date(doy, origin = "2016-01-01"))

max_soort <- max(aantallen_soort_stadium$aantal) * 1.2

 p <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal,
             group= locatie)) + 
  geom_point(alpha = 0.6) +  
 geom_line(linetype = 2,  alpha = 0.6, size = 0.4, colour = inbo_grijsblauw)  + 
  facet_grid(soort_nl ~ jaar) +
  labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90))
  p #ggplotly(p) 

 q <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal)) + 
  geom_point(alpha = 0.6) + 
  geom_smooth(method = "gam", method.args = list(family = poisson),formula = y ~ s(x, bs = "cs", k = 5) , size = 0.4, colour = "blue") +
  facet_grid(soort_nl ~ jaar) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
   labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90)) 
 q
```

### Beekrombout

```{r}
soort <- "Beekrombout"

```


```{r Beekromboutgemiddeld, fig.cap= str_c("Evolutie gemiddelde getelde aantallen per bezoek: ", soort), fig.height= 3, fig.width= 4}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
  filter(levensstadium == "larvenhuidje") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort) 

aantallen_soort_stadium %>%
  ggplot(aes(x= jaar, y = aantal)) +  
  #geom_point(alpha = 0.6, colour = inbo.grijs) +
  stat_summary(fun.data = "mean_cl_boot", colour = inbo_rood, size = 1, alpha = 0.8) +
  facet_wrap(~ soort_stadium, scale = "free_y") +
  labs(y = "Aantal getelde individuen", x = "Jaar") +
  theme(legend.position = "bottom") 

```

```{r Beekrombout, fig.cap= str_c("Evolutie getelde individuen binnen telperiode: ", soort) , message=FALSE, warning= FALSE, fig.width= 5, fig.height= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
   filter(primaire_soort) %>%
   filter(levensstadium == "larvenhuidje") %>%
   filter(meetnet == soort ) %>%
   mutate(doy_date = as.Date(doy, origin = "2016-01-01"))

max_soort <- max(aantallen_soort_stadium$aantal) * 1.2

 p <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal,
             group= locatie)) + 
  geom_point(alpha = 0.6) +  
 geom_line(linetype = 2,  alpha = 0.6, size = 0.4, colour = inbo_grijsblauw)  + 
  facet_grid(soort_nl ~ jaar) +
  labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  scale_x_date(date_breaks = "1 week", date_labels = "%b %d") +
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90))
  p #ggplotly(p) 
 
```

### Rivierrombout

```{r}
soort <- "Rivierrombout"

```

```{r Rivierromboutgemiddeld, fig.cap= str_c("Evolutie gemiddelde getelde aantallen per bezoek: ", soort), fig.height= 3, fig.width= 4}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
  filter(levensstadium == "larvenhuidje") %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort) 

aantallen_soort_stadium %>%
  ggplot(aes(x= jaar, y = aantal)) +  
  #geom_point(alpha = 0.6, colour = inbo.grijs) +
  stat_summary(fun.data = "mean_cl_boot", colour = inbo_rood, size = 1, alpha = 0.8) +
  facet_wrap(~ soort_stadium, scale = "free_y") +
  labs(y = "Aantal getelde individuen", x = "Jaar") +
  theme(legend.position = "bottom") 

```

```{r Rivierrombout, fig.cap= str_c("Evolutie getelde individuen binnen telperiode: ", soort) , message=FALSE, warning= FALSE, fig.width= 8, fig.height= 3}

aantallen_soort_stadium <- aantallen_bezoek_levensstadium %>%
   filter(primaire_soort) %>%
   filter(meetnet == soort ) %>%
   filter(levensstadium == "larvenhuidje") %>%
   mutate(doy_date = as.Date(doy, origin = "2016-01-01"))

max_soort <- max(aantallen_soort_stadium$aantal) * 1.2

 p <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal,
             group= locatie)) + 
  geom_point(alpha = 0.6) +  
 geom_line(linetype = 2,  alpha = 0.6, size = 0.4, colour = inbo_grijsblauw)  + 
  facet_grid(soort_nl ~ jaar) +
  labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90))
  p #ggplotly(p) 

 q <- aantallen_soort_stadium %>%
  ggplot(aes(x = doy_date, 
             y = aantal)) + 
  geom_point(alpha = 0.6) + 
  geom_smooth(method = "gam", method.args = list(family = poisson),formula = y ~ s(x, bs = "cs", k = 5) , size = 0.4, colour = "blue") +
  facet_grid(soort_nl ~ jaar) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
   labs(x = "Datum bezoek", y = "Aantal getelde individuen") + 
  ylim(0, max_soort) + 
  theme(legend.position = 'none', axis.text.x = element_text(angle = 90)) 
q
 
```










